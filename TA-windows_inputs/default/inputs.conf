####################
## Windows Inputs ##
####################
[WinEventLog://Application]
disabled = 0
renderXml = true
index = wineventlog


[WinEventLog://Security]
disabled = 0
renderXml = true
index = wineventlog
# blacklist from Windows Add-on
blacklist1 = EventCode="4662" Message="Object Type:(?!\s*groupPolicyContainer)"
blacklist2 = EventCode="566" Message="Object Type:(?!\s*groupPolicyContainer)"

# Additional blacklist - TODO - Check for below list of blacklist to see if you want enable or disable any, To enable uncomment the line with blacklist<no>

# 4798 - A user's local group membership was enumerated, 4799 - A security-enabled local group membership was enumerated
blacklist3 = 4798,4799

# 4634 -> account logged off
# blacklist4 = 4634

# 4658 -> The handle to an object was closed, 4663 -> An attempt was made to access an object
# blacklist5 = 4658, 4663

# 5447 - A Windows Filtering Platform filter has been changed, 5156 -> The Windows Filtering Platform has allowed a connection
# blacklist6 = 5447, 5156

# 4688 -> New process created, 4689 -> Process Terminated, sysmon events should cover for this. Enable the blacklist if Sysmon is used
# blacklist7 = 4688, 4689


[WinEventLog://System]
disabled = 0
renderXml = true
index = wineventlog


###### Windows Update Log ######
## Enable below stanza to get WindowsUpdate.log for Windows 8, Windows 8.1, Server 2008R2, Server 2012 and Server 2012R2
[monitor://$WINDIR\WindowsUpdate.log]
disabled = 0
index = windows

## Enable below powershell and monitor stanzas to get WindowsUpdate.log for Windows 10 and Server 2016
## Below stanza will automatically generate WindowsUpdate.log daily
[powershell://generate_windows_update_logs]
disabled = 0
index = windows

## Below stanza will monitor the generated WindowsUpdate.log in Windows 10 and Server 2016
[monitor://$SPLUNK_HOME\var\log\Splunk_TA_windows\WindowsUpdate.log]
disabled = 0
index = windows


###### Scripted Input (See also wmi.conf)
[script://.\bin\win_listening_ports.bat]
disabled = 0
index = windows

[script://.\bin\win_installed_apps.bat]
disabled = 0
index = windows

[script://.\bin\win_timesync_status.bat]
disabled = 0
index = windows

[script://.\bin\win_timesync_configuration.bat]
disabled = 0
index = windows

[script://.\bin\netsh_address.bat]
disabled = 0
index = windows


## Windows Registry Monitor
## TODO - Enable only if needed
[WinRegMon://default]
disabled = 1
index = windows

[WinRegMon://hkcu_run]
disabled = 1
index = windows

[WinRegMon://hklm_run]
disabled = 1
index = windows
